<main class="backgroundView">
  <h2 class="fw-bold mb-1" style="margin-left: 20px">Record New Produce Sale</h2>
  <p class="text-muted mb-4" style="margin-left: 20px">Fill in the details below to log a new produce sale</p>

  <div class="formDesign w-100">
    <form id="salesForm">
      <section class="mb-4">
        <h5 class="border-bottom pb-2">Produce Details</h5>
        <div class="Details d-flex flex-wrap gap-3">
          <label for="produceName">
            <p class="mb-1 small fw-bold">Produce Name</p>
            <select id="produceName" name="produceName" class="form-select" required style="min-width: 200px;">
              <option value="">Select Produce</option>
              <option value="Beans">Beans</option>
              <option value="Grain Maize">Grain Maize</option>
              <option value="Cow Peas">Cow Peas</option>
              <option value="G-nuts">G-nuts</option>
              <option value="Soybeans">Soybeans</option>
            </select>
          </label>

          <label for="tonnage">
            <p class="mb-1 small fw-bold">Tonnage (kgs)</p>
            <input
              id="tonnage"
              name="tonnage"
              type="number"
              class="form-control"
              min="1"
              required
              placeholder="e.g., 500"
            />
          </label>
        </div>
      </section>

      <section class="mb-4">
        <h5 class="border-bottom pb-2">Transaction Details</h5>
        <div class="Details d-flex flex-wrap gap-3">
          <label for="amountPaid">
            <p class="mb-1 small fw-bold">Amount Paid (UgX)</p>
            <input
              id="amountPaid"
              name="amountPaid"
              type="number"
              class="form-control"
              min="10000"
              required
              placeholder="e.g., 1500000"
            />
          </label>

          <label for="saleDate">
            <p class="mb-1 small fw-bold">Date of Sale</p>
            <input id="saleDate" name="saleDate" type="date" class="form-control" required />
          </label>

          <label for="saleTime">
            <p class="mb-1 small fw-bold">Time of Sale</p>
            <input id="saleTime" name="saleTime" type="time" class="form-control" required />
          </label>
        </div>
      </section>

      <section class="mb-4">
        <h5 class="border-bottom pb-2">Buyer & Agent Details</h5>
        <div class="Details d-flex flex-wrap gap-3">
          <label for="buyerName">
            <p class="mb-1 small fw-bold">Buyer Name</p>
            <input
              id="buyerName"
              name="buyerName"
              type="text"
              class="form-control"
              pattern="[A-Za-z0-9 ]{2,}"
              required
              placeholder="e.g., Lovemore Odongo"
            />
          </label>

          <label for="agentName">
            <p class="mb-1 small fw-bold">Sales Agent Name</p>
            <input
              id="agentName"
              name="agentName"
              type="text"
              class="form-control bg-light"
              required
              readonly
            />
          </label>

          <label for="branchName">
            <p class="mb-1 small fw-bold">Branch Name</p>
            <input
              id="branchName"
              name="branchName"
              type="text"
              class="form-control bg-light"
              value="Kiryandongo Branch"
              readonly
            />
          </label>
        </div>
      </section>

      <div class="formActions d-flex gap-2 justify-content-end mt-4">
        <button type="reset" class="btn btn-outline-secondary">Cancel</button>
        <button type="submit" class="btn btn-success px-4" style="background-color: green; border-color: green;">
          Save Sale
        </button>
      </div>
    </form>
  </div>
</main>

<script>
  // Auto-fill Agent Name from localStorage
  (function() {
    const _user = localStorage.getItem('userDetails');
    if (_user) {
      const user = JSON.parse(_user);
      const agentInput = document.getElementById('agentName');
      if (agentInput) {
        agentInput.value = `${user.firstName} ${user.lastName || user.lastname}`;
      }
    }

    // Set default date to today
    const dateInput = document.getElementById('saleDate');
    if(dateInput) {
      dateInput.value = new Date().toISOString().split('T')[0];
    }
  })();

  // Form Submission logic
  document.getElementById('salesForm').onsubmit = function(e) {
    e.preventDefault();
    // In a real app, you'd check stock availability here
    alert("Sale recorded successfully!");
  };
</script>